(function(){var e=YAHOO.util.Dom,b=YAHOO.util.Event;var a=Alfresco.util.encodeHTML;Alfresco.DynamicActivitiTransitions=function(g){Alfresco.DynamicActivitiTransitions.superclass.constructor.superclass.constructor.call(this,"Alfresco.DynamicActivitiTransitions",g,["button","container"]);return this};YAHOO.extend(Alfresco.DynamicActivitiTransitions,Alfresco.ActivitiTransitions,{buttons:[],form:null,states:[],options:{mandatoryFields:null},onReady:function c(){Alfresco.DynamicActivitiTransitions.superclass.onReady.call(this);this.form=this.buttons[this.options.transitions[0].id].getForm();for(var l in this.options.mandatoryFields){var h=this.options.mandatoryFields[l];for(var g in h){var m=h[g];var j=YAHOO.util.Selector.query('input[name="prop_'+m.replace(":","_")+'"]',this.form,true);var n=(function(o){return function(q){var t=o;q.forEach(function(u){var y=o;var v=u.target;var x=v.attributes.name.value;var w=x.substring(5).replace("_",":");y.states[w]=!v.attributes["alf-validation-msg"]||v.attributes["alf-validation-msg"].value==""});for(var r in t.options.mandatoryFields){var s=true;for(var p in t.options.mandatoryFields[r]){s=s&&t.states[t.options.mandatoryFields[r][p]]}t.buttons[r].set("disabled",!s)}}})(this);var i=new MutationObserver(n);var k={attributes:true,childList:false,characterData:false,attributeFilter:["alf-validation-msg"]};i.observe(j,k)}}},onClick:function d(h,i){for(var g in this.states){Alfresco.forms.Form.prototype._runValidations=function(){return true};break}Alfresco.DynamicActivitiTransitions.superclass.onClick.call(this,h,i)},_generateTransitionButton:function f(h){var g=document.createElement("input");g.setAttribute("id",this.id+"-"+h.id);g.setAttribute("value",h.label);g.setAttribute("type","button");e.get(this.id+"-buttons").appendChild(g);var g=Alfresco.util.createYUIButton(this,h.id,this.onClick);this.buttons[h.id]=g}})})();